/*
 * C-Script file for: C2000_28379D/Control
 * Generated with   : PLECS 4.8.3
 * Generated on     : 9 Oct 2024 18:16:58
 */
typedef float real_t;
#define REAL_MAX FLT_MAX
#define REAL_MIN FLT_MIN
#define REAL_EPSILON FLT_EPSILON
#include <float.h>
#include <math.h>
#include <time.h>
#include <stdio.h>
#include <complex.h>

/***** Entradas ****/
#define isa Input(0)
#define isb Input(1)
#define isc Input(2)

#define Vc_a Input(3)
#define Vc_b Input(4)
#define Vc_c Input(5)

#define i1a Input(6)
#define i1b Input(7)
#define i1c Input(8)

#define Pot Input(9)

/***** Salidas ****/
#define Out0 Output(0)
#define Out1 Output(1)
#define Out2 Output(2)

#define Out3 Output(3)

const float Vgd_r=220;
const float Vgq_r=0;
const float dp=6.28318530718;
float V_d=0, V_q=0;
float Vcd=0, Vcd_k0=0, Vcd_k1=0;
float Vcq=0, Vcq_k0=0, Vcq_k1=0;
float i2d_k=0, i2d_k0=0, i2d_k1=0;
float i2q_k=0, i2q_k0=0, i2q_k1=0;
float i1d_k=0, i1d_k0=0, i1d_k1=0;
float i1q_k=0, i1q_k0=0, i1q_k1=0;
float id=0, iq=0, theta=0;
float id_r=0, iq_r=0, Vcd_r=0, Vcq_r=0;
float g[125], g_opt=10000000;
float gv[125];
float gb[125];
float gg[125];
//float g[27], g_opt=10000000;
//float gv[27];
//float gb[27];
//float gg[27];

int x=0;
int x_opt=0;

//const float Sa[125]= {-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1};
//const float Sb[125]= {-1, -1, -1, -1, -1, -0.5, -0.5, -0.5, -0.5, -0.5, 0, 0, 0, 0, 0, 0.5, 0.5, 0.5, 0.5, 0.5, 1, 1, 1, 1, 1, -1, -1, -1, -1, -1, -0.5, -0.5, -0.5, -0.5, -0.5, 0, 0, 0, 0, 0, 0.5, 0.5, 0.5, 0.5, 0.5, 1, 1, 1, 1, 1, -1, -1, -1, -1, -1, -0.5, -0.5, -0.5, -0.5, -0.5, 0, 0, 0, 0, 0, 0.5, 0.5, 0.5, 0.5, 0.5, 1, 1, 1, 1, 1, -1, -1, -1, -1, -1, -0.5, -0.5, -0.5, -0.5, -0.5, 0, 0, 0, 0, 0, 0.5, 0.5, 0.5, 0.5, 0.5, 1, 1, 1, 1, 1, -1, -1, -1, -1, -1, -0.5, -0.5, -0.5, -0.5, -0.5, 0, 0, 0, 0, 0, 0.5, 0.5, 0.5, 0.5, 0.5, 1, 1, 1, 1, 1};
//const float Sc[125]= {-1, -0.5, 0, 0.5, 1, -1, -0.5, 0, 0.5, 1, -1, -0.5, 0, 0.5, 1, -1, -0.5, 0, 0.5, 1, -1, -0.5, 0, 0.5, 1, -1, -0.5, 0, 0.5, 1, -1, -0.5, 0, 0.5, 1, -1, -0.5, 0, 0.5, 1, -1, -0.5, 0, 0.5, 1, -1, -0.5, 0, 0.5, 1, -1, -0.5, 0, 0.5, 1, -1, -0.5, 0, 0.5, 1, -1, -0.5, 0, 0.5, 1, -1, -0.5, 0, 0.5, 1, -1, -0.5, 0, 0.5, 1, -1, -0.5, 0, 0.5, 1, -1, -0.5, 0, 0.5, 1, -1, -0.5, 0, 0.5, 1, -1, -0.5, 0, 0.5, 1, -1, -0.5, 0, 0.5, 1, -1, -0.5, 0, 0.5, 1, -1, -0.5, 0, 0.5, 1, -1, -0.5, 0, 0.5, 1, -1, -0.5, 0, 0.5, 1, -1, -0.5, 0, 0.5, 1};

//float Sa[27]= {-1,-1,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1};
//float Sb[27]= {-1,-1,-1,0,0,0,1,1,1,-1,-1,-1,0,0,0,1,1,1,-1,-1,-1,0,0,0,1,1,1};
//float Sc[27]= {-1,0,1,-1,0,1,-1,0,1,-1,0,1,-1,0,1,-1,0,1,-1,0,1,-1,0,1,-1,0,1};
float comb=0;

float vari1d=0;
float vari1q=0;
float varvcd=0;
float varvcq=0;
float vari2d=0;
float vari2q=0;

const float wh= 0.031415;
const float CS=0.66666666667;

float Sav[3]={
   0,0,0
};
float Sbv[3]={
   0,0,0
};
float Scv[3]={
   0,0,0
};

float Saopt=0;
float Sbopt=0;
float Scopt=0;
int a=0;
int b=0;
int c=0;
int i=0;
int j=0;
int k=0;
float error=0;
float error2=0;
float error3=0;
int muestra=0;

const float angulo[200] = {
   0.031415, 0.06283, 0.094245, 0.125661, 0.157076, 0.188491, 0.219906,
   0.251321, 0.282736, 0.314152, 0.345567, 0.376982, 0.408397, 0.439812,
   0.471227, 0.502643, 0.534058, 0.565473, 0.596888, 0.628303, 0.659718,
   0.691134, 0.722549, 0.753964, 0.785379, 0.816794, 0.848209, 0.879624,
   0.91104, 0.942455, 0.97387, 1.005285, 1.0367, 1.068115, 1.099531, 1.130946,
   1.162361, 1.193776, 1.225191, 1.256606, 1.288022, 1.319437, 1.350852,
   1.382267, 1.413682, 1.445097, 1.476513, 1.507928, 1.539343, 1.570758,
   1.602173, 1.633588, 1.665003, 1.696419, 1.727834, 1.759249, 1.790664,
   1.822079, 1.853494, 1.88491, 1.916325, 1.94774, 1.979155, 2.01057,
   2.041985, 2.073401, 2.104816, 2.136231, 2.167646, 2.199061, 2.230476,
   2.261892, 2.293307, 2.324722, 2.356137, 2.387552, 2.418967, 2.450382,
   2.481798, 2.513213, 2.544628, 2.576043, 2.607458, 2.638873, 2.670289,
   2.701704, 2.733119, 2.764534, 2.795949, 2.827364, 2.85878, 2.890195,
   2.92161, 2.953025, 2.98444, 3.015855, 3.047271, 3.078686, 3.110101,
   3.141516, 3.172931, 3.204346, 3.235761, 3.267177, 3.298592, 3.330007,
   3.361422, 3.392837, 3.424252, 3.455668, 3.487083, 3.518498, 3.549913,
   3.581328, 3.612743, 3.644159, 3.675574, 3.706989, 3.738404, 3.769819,
   3.801234, 3.83265, 3.864065, 3.89548, 3.926895, 3.95831, 3.989725, 4.02114,
   4.052556, 4.083971, 4.115386, 4.146801, 4.178216, 4.209631, 4.241047,
   4.272462, 4.303877, 4.335292, 4.366707, 4.398122, 4.429538, 4.460953,
   4.492368, 4.523783, 4.555198, 4.586613, 4.618029, 4.649444, 4.680859,
   4.712274, 4.743689, 4.775104, 4.806519, 4.837935, 4.86935, 4.900765,
   4.93218, 4.963595, 4.99501, 5.026426, 5.057841, 5.089256, 5.120671,
   5.152086, 5.183501, 5.214917, 5.246332, 5.277747, 5.309162, 5.340577,
   5.371992, 5.403408, 5.434823, 5.466238, 5.497653, 5.529068, 5.560483,
   5.591898, 5.623314, 5.654729, 5.686144, 5.717559, 5.748974, 5.780389,
   5.811805, 5.84322, 5.874635, 5.90605, 5.937465, 5.96888, 6.000296,
   6.031711, 6.063126, 6.094541, 6.125956, 6.157371, 6.188787, 6.220202,
   6.251617, 6.283032
};
const float cosenos[200] = {
   0.999507, 0.998027, 0.995562, 0.992115, 0.987689, 0.982288, 0.975918,
   0.968585, 0.960296, 0.951059, 0.940884, 0.92978, 0.917759, 0.904832,
   0.891012, 0.876313, 0.860749, 0.844335, 0.827089, 0.809026, 0.790165,
   0.770524, 0.750123, 0.728981, 0.70712, 0.684562, 0.661327, 0.637441,
   0.612925, 0.587804, 0.562103, 0.535848, 0.509063, 0.481777, 0.454014,
   0.425804, 0.397174, 0.368152, 0.338766, 0.309046, 0.279021, 0.248721,
   0.218175, 0.187414, 0.156469, 0.125368, 0.094144, 0.062827, 0.031448,
   3.8e-05, -0.031372, -0.062751, -0.094068, -0.125292, -0.156393, -0.187339,
   -0.218101, -0.248647, -0.278948, -0.308973, -0.338694, -0.36808, -0.397104,
   -0.425735, -0.453946, -0.481709, -0.508997, -0.535783, -0.56204, -0.587742,
   -0.612864, -0.637381, -0.66127, -0.684506, -0.707066, -0.728929, -0.750072,
   -0.770475, -0.790118, -0.808981, -0.827046, -0.844294, -0.86071, -0.876276,
   -0.890977, -0.904799, -0.917728, -0.929752, -0.940858, -0.951035,
   -0.960274, -0.968566, -0.975901, -0.982274, -0.987677, -0.992105,
   -0.995555, -0.998022, -0.999504, -1.0, -0.999509, -0.998032, -0.995569,
   -0.992125, -0.987701, -0.982302, -0.975935, -0.968604, -0.960317,
   -0.951083, -0.94091, -0.929808, -0.917789, -0.904864, -0.891047, -0.87635,
   -0.860788, -0.844376, -0.827132, -0.809071, -0.790212, -0.770573,
   -0.750173, -0.729034, -0.707175, -0.684618, -0.661385, -0.6375, -0.612985,
   -0.587866, -0.562166, -0.535912, -0.509129, -0.481844, -0.454083,
   -0.425874, -0.397244, -0.368223, -0.338838, -0.309119, -0.279095,
   -0.248795, -0.21825, -0.18749, -0.156544, -0.125444, -0.09422, -0.062904,
   -0.031525, -0.000115, 0.031295, 0.062674, 0.093992, 0.125216, 0.156317,
   0.187264, 0.218026, 0.248573, 0.278874, 0.3089, 0.338622, 0.368009,
   0.397033, 0.425666, 0.453878, 0.481642, 0.508931, 0.535718, 0.561976,
   0.58768, 0.612803, 0.637322, 0.661212, 0.68445, 0.707012, 0.728876,
   0.750021, 0.770426, 0.790071, 0.808936, 0.827003, 0.844253, 0.860671,
   0.876239, 0.890942, 0.904766, 0.917698, 0.929723, 0.940832, 0.951012,
   0.960253, 0.968547, 0.975884, 0.982259, 0.987665, 0.992096, 0.995548,
   0.998017, 0.999502, 1.0
};
const float senos[200]= {
   0.03141, 0.062789, 0.094106, 0.12533, 0.156431, 0.187377, 0.218138,
   0.248684, 0.278984, 0.30901, 0.33873, 0.368116, 0.397139, 0.42577, 0.45398,
   0.481743, 0.50903, 0.535815, 0.562071, 0.587773, 0.612894, 0.637411,
   0.661299, 0.684534, 0.707093, 0.728955, 0.750097, 0.7705, 0.790141,
   0.809003, 0.827067, 0.844315, 0.860729, 0.876294, 0.890994, 0.904815,
   0.917743, 0.929766, 0.940871, 0.951047, 0.960285, 0.968575, 0.97591,
   0.982281, 0.987683, 0.99211, 0.995559, 0.998024, 0.999505, 1.0, 0.999508,
   0.998029, 0.995566, 0.99212, 0.987695, 0.982295, 0.975926, 0.968594,
   0.960306, 0.951071, 0.940897, 0.929794, 0.917774, 0.904848, 0.891029,
   0.876331, 0.860768, 0.844356, 0.82711, 0.809049, 0.790188, 0.770548,
   0.750148, 0.729007, 0.707147, 0.68459, 0.661356, 0.63747, 0.612955,
   0.587835, 0.562135, 0.53588, 0.509096, 0.48181, 0.454049, 0.425839,
   0.397209, 0.368187, 0.338802, 0.309083, 0.279058, 0.248758, 0.218213,
   0.187452, 0.156506, 0.125406, 0.094182, 0.062865, 0.031487, 7.7e-05,
   -0.031333, -0.062712, -0.09403, -0.125254, -0.156355, -0.187302, -0.218063,
   -0.24861, -0.278911, -0.308937, -0.338658, -0.368045, -0.397068, -0.4257,
   -0.453912, -0.481676, -0.508964, -0.53575, -0.562008, -0.587711, -0.612834,
   -0.637352, -0.661241, -0.684478, -0.707039, -0.728903, -0.750047,
   -0.770451, -0.790094, -0.808958, -0.827024, -0.844274, -0.86069, -0.876257,
   -0.89096, -0.904783, -0.917713, -0.929738, -0.940845, -0.951023, -0.960264,
   -0.968556, -0.975893, -0.982267, -0.987671, -0.992101, -0.995551, -0.99802,
   -0.999503, -1.0, -0.99951, -0.998034, -0.995573, -0.992129, -0.987707,
   -0.98231, -0.975943, -0.968613, -0.960328, -0.951094, -0.940923, -0.929822,
   -0.917804, -0.904881, -0.891064, -0.876368, -0.860807, -0.844397,
   -0.827153, -0.809094, -0.790235, -0.770597, -0.750199, -0.72906, -0.707202,
   -0.684645, -0.661414, -0.637529, -0.613015, -0.587897, -0.562198,
   -0.535945, -0.509162, -0.481877, -0.454117, -0.425908, -0.397279,
   -0.368259, -0.338874, -0.309156, -0.279132, -0.248832, -0.218288,
   -0.187527, -0.156582, -0.125482, -0.094259, -0.062942, -0.031563, -0.000153
};
const float cosme2pi3[200] = {
   -0.472547, -0.444632, -0.416278, -0.387514, -0.358367, -0.328866,
   -0.299041, -0.268921, -0.238535, -0.207914, -0.177088, -0.146087,
   -0.114942, -0.083683, -0.052342, -0.02095, 0.010464, 0.041867, 0.073229,
   0.104518, 0.135705, 0.166757, 0.197645, 0.228338, 0.258805, 0.289018,
   0.318945, 0.348557, 0.377825, 0.40672, 0.435214, 0.463279, 0.490886,
   0.518009, 0.544621, 0.570695, 0.596206, 0.621129, 0.645439, 0.669112,
   0.692124, 0.714454, 0.736078, 0.756976, 0.777127, 0.796512, 0.81511,
   0.832904, 0.849876, 0.866009, 0.881287, 0.895696, 0.909221, 0.921849,
   0.933567, 0.944364, 0.954229, 0.963152, 0.971125, 0.978139, 0.984188,
   0.989266, 0.993368, 0.996489, 0.998627, 0.99978, 0.999946, 0.999125,
   0.997318, 0.994527, 0.990755, 0.986004, 0.980281, 0.973591, 0.965939,
   0.957335, 0.947786, 0.937301, 0.925892, 0.913568, 0.900344, 0.88623,
   0.871243, 0.855395, 0.838703, 0.821184, 0.802854, 0.783732, 0.763837,
   0.743188, 0.721805, 0.69971, 0.676925, 0.653471, 0.629373, 0.604654,
   0.579338, 0.55345, 0.527016, 0.500062, 0.472614, 0.444701, 0.416348,
   0.387584, 0.358438, 0.328939, 0.299114, 0.268995, 0.23861, 0.207989,
   0.177163, 0.146163, 0.115018, 0.08376, 0.052419, 0.021026, -0.010387,
   -0.04179, -0.073152, -0.104442, -0.135629, -0.166682, -0.19757, -0.228263,
   -0.258731, -0.288944, -0.318872, -0.348485, -0.377754, -0.40665, -0.435145,
   -0.463211, -0.490819, -0.517944, -0.544557, -0.570632, -0.596145,
   -0.621069, -0.64538, -0.669055, -0.692069, -0.7144, -0.736026, -0.756926,
   -0.777079, -0.796465, -0.815065, -0.832861, -0.849835, -0.86597, -0.881251,
   -0.895662, -0.909189, -0.921819, -0.93354, -0.944339, -0.954206, -0.963131,
   -0.971106, -0.978123, -0.984175, -0.989255, -0.993359, -0.996483,
   -0.998623, -0.999778, -0.999946, -0.999128, -0.997324, -0.994535,
   -0.990765, -0.986017, -0.980296, -0.973608, -0.965959, -0.957357, -0.94781,
   -0.937328, -0.92592, -0.913599, -0.900377, -0.886266, -0.87128, -0.855435,
   -0.838745, -0.821228, -0.8029, -0.78378, -0.763886, -0.743239, -0.721858,
   -0.699765, -0.676981, -0.653529, -0.629433, -0.604715, -0.5794, -0.553514,
   -0.527081, -0.500128
};
const float cosma2pi3[200] = {
   -0.526951, -0.553386, -0.579275, -0.604593, -0.629313, -0.653413,
   -0.676868, -0.699655, -0.721752, -0.743136, -0.763787, -0.783685,
   -0.802808, -0.82114, -0.838662, -0.855355, -0.871205, -0.886195, -0.90031,
   -0.913537, -0.925863, -0.937274, -0.947761, -0.957313, -0.96592, -0.973573,
   -0.980266, -0.985992, -0.990744, -0.994519, -0.997312, -0.999122,
   -0.999945, -0.999781, -0.998631, -0.996496, -0.993377, -0.989277,
   -0.984202, -0.978155, -0.971143, -0.963173, -0.954252, -0.944389,
   -0.933595, -0.921879, -0.909253, -0.89573, -0.881324, -0.866047, -0.849916,
   -0.832946, -0.815154, -0.796558, -0.777176, -0.757026, -0.73613, -0.714507,
   -0.692179, -0.669169, -0.645497, -0.621189, -0.596268, -0.570758,
   -0.544685, -0.518075, -0.490953, -0.463347, -0.435283, -0.40679, -0.377896,
   -0.348629, -0.319017, -0.289091, -0.25888, -0.228413, -0.19772, -0.166833,
   -0.135781, -0.104595, -0.073305, -0.041944, -0.010541, 0.020873, 0.052266,
   0.083607, 0.114866, 0.146011, 0.177013, 0.207839, 0.238461, 0.268847,
   0.298968, 0.328794, 0.358295, 0.387443, 0.416209, 0.444563, 0.472479,
   0.499929, 0.526886, 0.553322, 0.579213, 0.604532, 0.629254, 0.653355,
   0.676812, 0.699601, 0.721699, 0.743085, 0.763738, 0.783637, 0.802763,
   0.821096, 0.83862, 0.855316, 0.871167, 0.886159, 0.900277, 0.913506,
   0.925834, 0.937248, 0.947737, 0.957291, 0.9659, 0.973556, 0.980251,
   0.985979, 0.990734, 0.994511, 0.997307, 0.999118, 0.999944, 0.999783,
   0.998635, 0.996502, 0.993385, 0.989289, 0.984215, 0.978171, 0.971161,
   0.963193, 0.954275, 0.944414, 0.933622, 0.921908, 0.909285, 0.895764,
   0.88136, 0.866085, 0.849956, 0.832989, 0.815199, 0.796604, 0.777224,
   0.757077, 0.736182, 0.714561, 0.692235, 0.669226, 0.645556, 0.621249,
   0.596329, 0.570821, 0.544749, 0.51814, 0.49102, 0.463415, 0.435352,
   0.40686, 0.377967, 0.3487, 0.31909, 0.289164, 0.258954, 0.228487, 0.197795,
   0.166908, 0.135857, 0.104671, 0.073382, 0.04202, 0.010617, -0.020796,
   -0.052189, -0.083531, -0.11479, -0.145935, -0.176937, -0.207764, -0.238386,
   -0.268773, -0.298895, -0.328721, -0.358224, -0.387372, -0.416139,
   -0.444495, -0.472412, -0.499863
};
const float sinme2pi3[200] = {
   -0.881306, -0.895713, -0.909237, -0.921864, -0.933581, -0.944377, -0.95424,
   -0.963162, -0.971134, -0.978147, -0.984195, -0.989272, -0.993372,
   -0.996492, -0.998629, -0.999781, -0.999945, -0.999123, -0.997315,
   -0.994523, -0.990749, -0.985998, -0.980274, -0.973582, -0.965929,
   -0.957324, -0.947773, -0.937288, -0.925877, -0.913553, -0.900327,
   -0.886213, -0.871224, -0.855375, -0.838682, -0.821162, -0.802831,
   -0.783708, -0.763812, -0.743162, -0.721778, -0.699683, -0.676896,
   -0.653442, -0.629343, -0.604623, -0.579306, -0.553418, -0.526983,
   -0.500029, -0.472581, -0.444666, -0.416313, -0.387549, -0.358403,
   -0.328902, -0.299078, -0.268958, -0.238572, -0.207952, -0.177126,
   -0.146125, -0.11498, -0.083722, -0.052381, -0.020988, 0.010426, 0.041829,
   0.073191, 0.10448, 0.135667, 0.166719, 0.197607, 0.228301, 0.258768,
   0.288981, 0.318908, 0.348521, 0.377789, 0.406685, 0.43518, 0.463245,
   0.490853, 0.517976, 0.544589, 0.570664, 0.596175, 0.621099, 0.645409,
   0.669083, 0.692097, 0.714427, 0.736052, 0.756951, 0.777103, 0.796489,
   0.815088, 0.832882, 0.849855, 0.86599, 0.881269, 0.895679, 0.909205,
   0.921834, 0.933553, 0.944351, 0.954217, 0.963142, 0.971116, 0.978131,
   0.984181, 0.989261, 0.993363, 0.996486, 0.998625, 0.999779, 0.999946,
   0.999126, 0.997321, 0.994531, 0.99076, 0.986011, 0.980289, 0.973599,
   0.965949, 0.957346, 0.947798, 0.937314, 0.925906, 0.913584, 0.90036,
   0.886248, 0.871261, 0.855415, 0.838724, 0.821206, 0.802877, 0.783756,
   0.763862, 0.743213, 0.721832, 0.699737, 0.676953, 0.6535, 0.629403,
   0.604684, 0.579369, 0.553482, 0.527049, 0.500095, 0.472648, 0.444735,
   0.416383, 0.38762, 0.358474, 0.328975, 0.299151, 0.269032, 0.238647,
   0.208027, 0.177201, 0.146201, 0.115056, 0.083798, 0.052457, 0.021065,
   -0.010349, -0.041752, -0.073114, -0.104404, -0.135591, -0.166644,
   -0.197532, -0.228226, -0.258694, -0.288908, -0.318836, -0.348449,
   -0.377718, -0.406615, -0.435111, -0.463177, -0.490786, -0.517911,
   -0.544524, -0.570601, -0.596114, -0.621039, -0.645351, -0.669026,
   -0.692041, -0.714373, -0.736, -0.756901, -0.777055, -0.796442, -0.815043,
   -0.83284, -0.849815, -0.865951
};
const float sinma2pi3[200] = {
   0.849896, 0.832925, 0.815132, 0.796535, 0.777152, 0.757001, 0.736104,
   0.714481, 0.692152, 0.66914, 0.645468, 0.621159, 0.596237, 0.570727,
   0.544653, 0.518042, 0.49092, 0.463313, 0.435249, 0.406755, 0.37786,
   0.348593, 0.318981, 0.289054, 0.258842, 0.228375, 0.197683, 0.166795,
   0.135743, 0.104556, 0.073267, 0.041905, 0.010502, -0.020911, -0.052304,
   -0.083645, -0.114904, -0.146049, -0.17705, -0.207877, -0.238498, -0.268884,
   -0.299004, -0.32883, -0.358331, -0.387478, -0.416243, -0.444598, -0.472513,
   -0.499962, -0.526918, -0.553354, -0.579244, -0.604562, -0.629284,
   -0.653384, -0.67684, -0.699628, -0.721725, -0.743111, -0.763763, -0.783661,
   -0.802786, -0.821118, -0.838641, -0.855335, -0.871186, -0.886177,
   -0.900294, -0.913522, -0.925848, -0.937261, -0.947749, -0.957302, -0.96591,
   -0.973564, -0.980258, -0.985985, -0.990739, -0.994515, -0.99731, -0.99912,
   -0.999944, -0.999782, -0.998633, -0.996499, -0.993381, -0.989283,
   -0.984209, -0.978163, -0.971152, -0.963183, -0.954263, -0.944402,
   -0.933608, -0.921894, -0.909269, -0.895747, -0.881342, -0.866066,
   -0.849936, -0.832967, -0.815176, -0.796581, -0.7772, -0.757051, -0.736156,
   -0.714534, -0.692207, -0.669197, -0.645527, -0.621219, -0.596299, -0.57079,
   -0.544717, -0.518107, -0.490986, -0.463381, -0.435318, -0.406825,
   -0.377931, -0.348664, -0.319054, -0.289128, -0.258917, -0.22845, -0.197758,
   -0.166871, -0.135819, -0.104633, -0.073343, -0.041982, -0.010579, 0.020835,
   0.052228, 0.083569, 0.114828, 0.145973, 0.176975, 0.207802, 0.238424,
   0.26881, 0.298931, 0.328758, 0.358259, 0.387408, 0.416174, 0.444529,
   0.472446, 0.499896, 0.526853, 0.55329, 0.579181, 0.604501, 0.629224,
   0.653326, 0.676784, 0.699573, 0.721672, 0.743059, 0.763713, 0.783613,
   0.80274, 0.821075, 0.838599, 0.855296, 0.871148, 0.886142, 0.90026,
   0.91349, 0.925819, 0.937234, 0.947724, 0.957279, 0.96589, 0.973547,
   0.980243, 0.985972, 0.990729, 0.994507, 0.997304, 0.999117, 0.999944,
   0.999784, 0.998637, 0.996505, 0.99339, 0.989294, 0.984222, 0.978179,
   0.97117, 0.963204, 0.954286, 0.944427, 0.933636, 0.921923, 0.909301,
   0.895782, 0.881378, 0.866105
};









struct CScriptStruct
{
   int numInputTerminals;
   int numOutputTerminals;
   int* numInputSignals;
   int* numOutputSignals;
   int numContStates;
   int numDiscStates;
   int numZCSignals;
   int numSampleTimes;
   int numParameters;
   int isMajorTimeStep;
   float time;
   const float ***inputs;
   float ***outputs;
   float *contStates;
   float *contDerivs;
   float *discStates;
   float *zCSignals;
   const int *paramNumDims;
   const int **paramDims;
   const int *paramNumElements;
   const float **paramRealData;
   const char **paramStringData;
   const char * const *sampleHits;
   const float *sampleTimePeriods;
   const float *sampleTimeOffsets;
   const float * const *inputSampleTimePeriods;
   const float * const *inputSampleTimeOffsets;
   float *nextSampleHit;
   const char** errorStatus;
   const char** warningStatus;
   const char** rangeErrorMsg;
   int* rangeErrorLine;
   void (*writeCustomStateDouble)(void*, float);
   float (*readCustomStateDouble)(void*);
   void (*writeCustomStateInt)(void*, int);
   void (*writeCustomStateData)(void*, const void*, int);
   void (*readCustomStateData)(void*, void*, int);
};
#define NumInputs cScriptStruct->numInputSignals[0]
#define NumOutputs cScriptStruct->numOutputSignals[0]
#define Input(signalIdx) (*cScriptStruct->inputs[0][signalIdx])
#define Output(signalIdx) (*cScriptStruct->outputs[0][signalIdx])
#define NumInputTerminals cScriptStruct->numInputTerminals
#define NumOutputTerminals cScriptStruct->numOutputTerminals
#define NumInputSignals(terminalIdx) cScriptStruct->numInputSignals[ \
      terminalIdx]
#define NumOutputSignals(terminalIdx) cScriptStruct->numOutputSignals[ \
      terminalIdx]
#define InputSignal(terminalIdx, \
                    signalIdx) (*cScriptStruct->inputs[terminalIdx][signalIdx])
#define OutputSignal(terminalIdx, \
                     signalIdx) (*cScriptStruct->outputs[terminalIdx][ \
                                    signalIdx])
#define NumContStates cScriptStruct->numContStates
#define NumDiscStates cScriptStruct->numDiscStates
#define NumZCSignals cScriptStruct->numZCSignals
#define NumParameters cScriptStruct->numParameters
#define NumSampleTimes cScriptStruct->numSampleTimes
#define IsMajorStep cScriptStruct->isMajorTimeStep
#define CurrentTime cScriptStruct->time
#define NextSampleHit (*cScriptStruct->nextSampleHit)
#define SetErrorMessage(string) { *cScriptStruct->errorStatus=(string); }
#define SetWarningMessage(string)
#define ContState(idx) cScriptStruct->contStates[idx]
#define ContDeriv(idx) cScriptStruct->contDerivs[idx]
#define DiscState(idx) cScriptStruct->discStates[idx]
#define ZCSignal(idx) cScriptStruct->zCSignals[idx]
#define IsSampleHit(idx) (*cScriptStruct->sampleHits[idx])
#define SampleTimePeriod(idx) cScriptStruct->sampleTimePeriods[idx]
#define SampleTimeOffset(idx) cScriptStruct->sampleTimeOffsets[idx]
#define InputSampleTimePeriod(terminalIdx, \
                              signalIdx) cScriptStruct->inputSampleTimePeriods \
   [terminalIdx][signalIdx]
#define InputSampleTimeOffset(terminalIdx, \
                              signalIdx) cScriptStruct->inputSampleTimeOffsets \
   [terminalIdx][signalIdx]
#define ParamNumDims(idx) cScriptStruct->paramNumDims[idx]
#define ParamDim(pIdx, dIdx) cScriptStruct->paramDims[pIdx][dIdx]
#define ParamRealData(pIdx, dIdx) cScriptStruct->paramRealData[pIdx][dIdx]
#define ParamStringData(pIdx) cScriptStruct->paramStringData[pIdx]

void C2000_28379D_0_cScriptStart(const struct CScriptStruct *cScriptStruct)
{
}

void C2000_28379D_0_cScriptOutput(const struct CScriptStruct *cScriptStruct)
{
   Out0=Saopt;
   Out1=Sbopt;
   Out2=Scopt;

   Out3=angulo[muestra];
}

void C2000_28379D_0_cScriptUpdate(const struct CScriptStruct *cScriptStruct)
{
   /************ Forma angulo ************/
   muestra+=1;
   if(muestra > 199)
   {
      muestra=1;
   }

   /************ Referencias ************/

   id_r = Pot/Vgd_r;
   iq_r = 0.314151*(id_r);  // w*L2*id_r
   Vcd_r = Vgd_r+(id_r)*0.001 - 0.314151*(iq_r);
   Vcq_r = Vgq_r+(iq_r)*0.001 + 0.314151*(id_r);

   /************ Vector de corriente medida salida del conv ************/

   i1d_k=CS*
          (i1a*cosenos[muestra]+i1b*cosme2pi3[muestra]+i1c*
           cosma2pi3[muestra]);
   i1q_k=-CS*
          (i1a*senos[muestra]+i1b*sinme2pi3[muestra]+i1c*sinma2pi3[muestra]);

   /************ Vector de corriente medida en carga ************/

   i2d_k=CS*
          (isa*cosenos[muestra]+isb*cosme2pi3[muestra]+isc*
           cosma2pi3[muestra]);
   i2q_k=-CS*
          (isa*senos[muestra]+isb*sinme2pi3[muestra]+isc*sinma2pi3[muestra]);

   /************ Vector de tension capacitores ************/

   Vcd=CS*
        (Vc_a*cosenos[muestra]+Vc_b*cosme2pi3[muestra]+Vc_c*
         cosma2pi3[muestra]);
   Vcq=-CS*
        (Vc_a*senos[muestra]+Vc_b*sinme2pi3[muestra]+Vc_c*sinma2pi3[muestra]);

   /************ Tension Convertidor ************/

   V_d=266.666666*
        (Saopt*cosenos[muestra]+Sbopt*cosme2pi3[muestra]+Scopt*
         cosma2pi3[muestra]);
   V_q=-266.666666*
        (Saopt*senos[muestra]+Sbopt*sinme2pi3[muestra]+Scopt*
         sinma2pi3[muestra]);

   /************ PredicciÃ³n k+1 ************/
   i1d_k0= (0.05)*(V_d-Vcd) + wh*i1q_k + i1d_k; // h*d1_L1 d1_L1=500;
   i1q_k0= (0.05)*(V_q-Vcq) - wh*i1d_k + i1q_k;

   Vcd_k0=(0.1)*(i1d_k0-i2d_k) + wh*Vcq + Vcd;  // h*d1_c  d1_c=1000;
   Vcq_k0=(0.1)*(i1q_k0-i2q_k) - wh*Vcd + Vcq;

   i2d_k0 = (0.1)*(Vcd_k0-Vgd_r-i2d_k*0.001) + i2d_k + wh*i2q_k; // h*d1_L2  d1_L2=1000;
   i2q_k0 = (0.1)*(Vcq_k0-Vgq_r-i2q_k*0.001) + i2q_k - wh*i2d_k;

   /*** Calculo preliminar para minimizar calculos en loop ****/

   vari1d=wh*i1q_k0 + i1d_k0 - Vcd_k0*0.05;
   vari1q=wh*i1d_k0 - i1q_k0 + Vcq_k0*0.05;

   varvcd=wh*Vcq_k0 + Vcd_k0 - i2d_k0*0.1;
   varvcq=-i2q_k0*0.1 -wh*Vcd_k0 + Vcq_k0;

   vari2d=i2d_k0 + wh*i2q_k0 - (0.1)*(Vgd_r+i2d_k0*0.001);
   vari2q=i2q_k0 - wh*i2d_k0 - (0.1)*(Vgq_r+i2q_k0*0.001);

   /**** Reducir combinaciones posibles de Loop ***/

   if(Saopt > -1 && Saopt < 1)
   {
      Sav[0]=Saopt-0.5;
      Sav[1]=Saopt;
      Sav[2]=Saopt+0.5;
      a=2;
   }
   if(Saopt == -1)
   {
      Sav[0]=-1;
      Sav[1]=-0.5;
      a=1;
   }
   if(Saopt == 1)
   {
      Sav[0]=0.5;
      Sav[1]=1;
      a=1;
   }

   if(Sbopt > -1 && Sbopt < 1)
   {
      Sbv[0]=Sbopt-0.5;
      Sbv[1]=Sbopt;
      Sbv[2]=Sbopt+0.5;
      b=2;
   }
   if(Sbopt == -1)
   {
      Sbv[0]=-1;
      Sbv[1]=-0.5;
      b=1;
   }
   if(Sbopt == 1)
   {
      Sbv[0]=0.5;
      Sbv[1]=1;
      b=1;
   }

   if(Scopt > -1 && Scopt < 1)
   {
      Scv[0]=Scopt-0.5;
      Scv[1]=Scopt;
      Scv[2]=Scopt+0.5;
      c=2;
   }
   if(Scopt == -1)
   {
      Scv[0]=-1;
      Scv[1]=-0.5;
      c=1;
   }
   if(Scopt == 1)
   {
      Scv[0]=0.5;
      Scv[1]=1;
      c=1;
   }
   g_opt=1e20;
   for(i=0; i <= a; i+=1)
   {
      for(j=0; j <= b; j+=1)
      {
         for(k=0; k <= c; k+=1)
         {
            V_d=266.666666*
                 (Sav[i]*cosenos[muestra]+Sbv[j]*cosme2pi3[muestra]+Scv[k]*
                  cosma2pi3[muestra]);
            V_q=-266.666666*
                 (Sav[i]*senos[muestra]+Sbv[j]*sinme2pi3[muestra]+Scv[k]*
                  sinma2pi3[muestra]);

            i1d_k1= (0.05)*(V_d) + vari1d;
            i1q_k1= (0.05)*(V_q) - vari1q;

            Vcd_k1=(0.1)*(i1d_k1) + varvcd;
            Vcq_k1=(0.1)*(i1q_k1) - varvcq;

            i2d_k1 = (0.1)*(Vcd_k1) + vari2d;
            i2q_k1 = (0.1)*(Vcq_k1) + vari2q;

            error=
               sqrtf((id_r -
                      i1d_k1)*
                     ((id_r) - i1d_k1)) + sqrtf(
                                                (iq_r -
                                                 i1q_k1)*(iq_r - i1q_k1));
            error2=
               sqrtf((id_r -
                      i2d_k1)*
                     (id_r -
                      i2d_k1)) + sqrtf((iq_r - i2q_k1)*(iq_r - i2q_k1));
            error3=
               sqrtf((Vcd_r - Vcd_k1)*(Vcd_r - Vcd_k1)) + sqrtf(
                                                                (Vcq_r -
                                                                 Vcq_k1)*
                                                                (Vcq_r -
                                                                 Vcq_k1));
            if (0.3333*(error+error2+error3) < g_opt)
            {
               g_opt = 0.3333*(error+error2+error3);
               Saopt=Sav[i];
               Sbopt=Sbv[j];
               Scopt=Scv[k];
            }
            ;
         }
      }
   }
}

void C2000_28379D_0_cScriptDerivative(
                                      const struct CScriptStruct *cScriptStruct)
{
}

void C2000_28379D_0_cScriptTerminate(const struct CScriptStruct *cScriptStruct)
{
}
